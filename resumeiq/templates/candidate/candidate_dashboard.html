{% extends "base.html" %}
{% block title %}Candidate Dashboard{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white p-8 rounded-lg shadow">

  <h2 class="text-2xl font-semibold mb-6">
    Resume Analysis
  </h2>

  <!-- Upload -->
  <input type="file" id="resume" class="w-full p-3 border rounded mb-4">

  <!-- Target Role -->
  <label class="block mb-2 font-medium">
    Target Job Role (optional)
  </label>

  <select id="targetRole" class="w-full p-3 border rounded mb-4">
    <option value="">-- Select role --</option>
    <option>Backend Developer</option>
    <option>Data Analyst</option>
    <option>Machine Learning Engineer</option>
    <option>Full Stack Developer</option>
  </select>

  <button onclick="analyzeResume()"
    class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded">
    Analyze Resume
  </button>

  <!-- RESULTS -->
  <div id="resultCard" class="hidden mt-10">

    <h3 class="text-lg font-semibold mb-6">
      Analysis Result
    </h3>

    <!-- ATS SCORE VISUAL -->
    <div class="flex items-center gap-8 mb-8">

      <div class="relative w-28 h-28">
        <svg class="w-full h-full transform -rotate-90">
          <circle cx="56" cy="56" r="48"
            stroke="#e5e7eb"
            stroke-width="10"
            fill="none" />
          <circle id="atsCircle"
            cx="56" cy="56" r="48"
            stroke="#2563eb"
            stroke-width="10"
            fill="none"
            stroke-dasharray="301"
            stroke-dashoffset="301"
            stroke-linecap="round" />
        </svg>
        <div class="absolute inset-0 flex items-center justify-center text-lg font-semibold">
          <span id="atsText">0%</span>
        </div>
      </div>

      <div>
        <p class="text-gray-700 font-medium">ATS Compatibility</p>
        <p class="text-sm text-gray-500">
          Measures how well your resume fits ATS systems
        </p>
      </div>

    </div>

    <!-- BEST ROLE -->
    <p class="mb-4">
      <strong>Best Fit Role:</strong>
      <span id="bestRole" class="text-blue-600 font-semibold"></span>
    </p>

    <!-- ROLE FIT BAR -->
    <div class="mb-6">
      <p class="font-medium mb-2">
        Role Fit Percentage
      </p>
      <div class="w-full bg-gray-200 rounded-full h-3">
        <div id="roleBar"
          class="bg-purple-600 h-3 rounded-full transition-all duration-700"
          style="width: 0%"></div>
      </div>
      <p class="text-sm text-gray-600 mt-1">
        <span id="roleFit"></span> match with selected role
      </p>
    </div>

    <!-- SUGGESTIONS -->
    <div>
      <p class="font-medium mb-2">
        Resume Improvement Suggestions
      </p>
      <ul id="recommendations" class="list-disc ml-5 text-sm text-gray-700"></ul>
    </div>

  </div>

</div>

<script src="{{ url_for('static', filename='js/candidate.js') }}"></script>
{% endblock %}